name: Build for pyodide

on:
  push:
    branches:
      - main
  pull_request:

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
          - uses: actions/checkout@v3
          - uses: actions/setup-python@v4
            with:
               python-version: 3.10.2
          - uses: mymindstorm/setup-emsdk@v11
            with:
               version: 3.1.14
          - name: Verify emsdk
            run: emcc -v
          - run: pip install pyodide-build==0.21.0
          - run: CMAKE_MAKE_PROGRAM=make pyodide build
          - uses: actions/upload-artifact@v3
            with:
               name: wheel distribution for pyodide
               path: dist
